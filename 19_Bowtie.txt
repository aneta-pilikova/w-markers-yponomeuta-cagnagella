#!/bin/bash -l
#PBS -l select=1:ncpus=16:mem=64gb:scratch_local=50gb
#PBS -l walltime=48:00:00
#PBS -N bowtie2_mapping_F_kmers_to_F_ONT

module load bowtie2-2.2.9 samtools-1.3.1

trap 'clean_scratch' TERM EXIT

cd ${SCRATCHDIR}

cp /path/to/single_line_Ycag_F_ONT_flye.fasta ${SCRATCHDIR}

bowtie2-build single_line_Ycag_F_ONT_flye.fasta basename_Ycag_F_ONT_flye || exit 1

cp /path/to/Ycag_list_of_female_unique_kmers.fasta ${SCRATCHDIR} || exit 2

bowtie2 -x <bt2-idx> {-1 <m1> -2 <m2> | -U <r>} [-S <sam>]
/software/bowtie/2.2.9/bin/bowtie2 -f -D 24 -R 3 -N 0 -L 12 -i S,1,0.30 -x basename_Ycag_F_ONT_flye -U Ycag_list_of_female_unique_kmers.fasta | /software/samtools/1.3.1/bin/samtools view -b -o $

cp -r ${SCRATCHDIR}/Ycag_list_of_female_unique_kmers.bam /path/to/bowtie2_output/ || export CLEAN_SCRATCH=false